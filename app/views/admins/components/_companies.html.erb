<%
  # BigBlueButton open source conferencing system - http://www.bigbluebutton.org/.
  # Copyright (c) 2018 BigBlueButton Inc. and by respective authors (see below).
  # This program is free software; you can redistribute it and/or modify it under the
  # terms of the GNU Lesser General Public License as published by the Free Software
  # Foundation; either version 3.0 of the License, or (at your option) any later
  # version.
  #
  # BigBlueButton is distributed in the hope that it will be useful, but WITHOUT ANY
  # WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A
  # PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.
  # You should have received a copy of the GNU Lesser General Public License along
  # with BigBlueButton; if not, see <http://www.gnu.org/licenses/>.
%>

<%# if @role.nil? %>
  <%#= render "admins/components/manage_users_tags" %>
<%# else %>
  <%#= render "admins/components/admins_tags" %>
<%# end %>

<div class="form-group">
  <div class="row">
    <div class="col-12">
      <div class="table-responsive">
        <%= link_to admin_add_company_path, class: "dropdown-item" do %>
          <button class="btn-primary">
            <i class="fas fa fa-building"></i> <%= t("administrator.companies.add_company") %>
          </button>
        <% end %>
        <table class="table table-hover table-outline table-vcenter card-table">
          <thead>
          <tr>
            <th data-header="name" data-order="<%= @order_column == "name" ? @order_direction : "none" %>">
              <%= t("administrator.companies.table.name") %>
              <% if @order_column == "name" && @order_direction == "desc" %>
                ↓
              <% elsif @order_column == "name" && @order_direction == "asc" %>
                ↑
              <% end %>
            </th>
            <th data-header="description">
              <%= t("administrator.companies.table.description") %>
            </th>
            <th class="text-center">
            </th>
          </tr>
          </thead>
          <tbody id="users-table">
          <tr id="no_companies_found" style="display: none;">
            <td colspan="7" class="text-center h4 p-6 font-weight-normal" >
              <%= t("administrator.companies.table.not_found") %>
            </td>
          </tr>
          <% if @companies %>
            <% @companies.each do |company| %>
              <tr data-user-uid="<%= company.id %>">
                <td>
                  <div><%= company.name %></div>
                  <div class="small text-muted"><%= [t("administrator.companies.table.created"), ": ", company.created_at].join %></div>
                </td>
                <td>
                  <div><%= company.description %></div>
                </td>
                <td>
                    <div class="item-action dropdown">
                      <a href="javascript:void(0)" data-toggle="dropdown" class="icon">
                        <i class="fas fa-ellipsis-v px-4"></i>
                      </a>
                      <div class="dropdown-menu dropdown-menu">
                        <%= link_to admin_edit_company_path(company_id: company.id), class: "dropdown-item", "data-disable": "" do %>
                          <i class="dropdown-icon fas fa-edit"></i> <%= t("administrator.companies.table.edit_company") %>
                        <% end %>
                        <%#= button_to admin_undelete_path(company_id: company.id), class: "dropdown-item", "data-disable": "" do %>
<!--                          <i class="dropdown-icon fas fa-users"></i> <%#= t("administrator.companies.table.manage_user") %>-->
                        <%# end %>
                        <%= button_to delete_company_path(company_id: company.id), data: { confirm: t("modal.delete_company.confirm") }, method: :delete, class: "dropdown-item", "data-disable": "" do %>
                          <i class="dropdown-icon fas fa-trash-alt"></i> <%= t("administrator.companies.table.delete") %>
                        <% end %>
<!--                        <button class= "delete-user dropdown-item" data-path="<%#= delete_company_path(company_id: company.id) %>" data-delete="temp-delete" data-toggle="modal" data-target="#deleteCompanyModal">-->
<!--                          <i class="dropdown-icon fas fa-trash-alt"></i> <%#= t("administrator.companies.table.delete") %>-->
<!--                        </button>-->
                      </div>
                    </div>
                </td>
              </tr>
            <% end %>
          <% else %>
            <tr>
              <td colspan="7" class="text-center h4 p-6 font-weight-normal" >
                <%= t("administrator.companies.table.no_companies") %>
              </td>
            </tr>
          <% end %>
          </tbody>
        </table>
        <div class="float-md-right mt-4">
          <%== pagy_bootstrap_nav(@pagy) %>
        </div>
      </div>
    </div>
  </div>
</div>

<%#= render "shared/modals/invite_user_modal" %>
<%= render "shared/modals/delete_company_modal", delete_location: relative_root %>
<%#= render "shared/modals/merge_user_modal" %>
